# Implementation Plan: AgentSpec Documentation Site

**Branch**: `005-docs-site` | **Date**: 2026-02-23 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/005-docs-site/spec.md`

## Summary

Build a comprehensive documentation site for AgentSpec using MkDocs + Material for MkDocs. The site has two audience sections (User Guide and Developer Guide), a complete IntentLang 2.0 language reference, 7+ agentic architecture use cases, deployment guides for all targets, CLI and HTTP API references, SDK documentation, and contributor guides. Code examples are validated via a Go integration test. The site deploys to GitHub Pages via GitHub Actions.

## Technical Context

**Language/Version**: Python 3.9+ (MkDocs), Go 1.25+ (example validation), Markdown (content)
**Primary Dependencies**:
- mkdocs-material v9.x (documentation framework + theme)
- pymdownx-extensions (Mermaid diagrams, syntax highlighting, tabbed content)
- Custom Pygments lexer for IntentLang syntax highlighting (~80 lines Python)
- `agentspec` CLI binary (built from source for example validation in CI)
**Storage**: N/A (static site, no database)
**Testing**: `go test ./integration_tests/ -run TestDoc` (code example validation including markdown code blocks), `mkdocs build` (link/structure validation — `--strict` omitted because mkdocs-material emits an upstream MkDocs 2.0 deprecation warning that fails strict mode)
**Target Platform**: Static HTML site deployed to GitHub Pages
**Project Type**: Documentation site (static content generation)
**Performance Goals**: Site build <5 minutes in CI (SC-006). Actual MkDocs builds take ~30 seconds.
**Constraints**: All `.ias` code examples must pass validation. Markdown source format. Mermaid for diagrams. No external service dependencies for search.
**Scale/Scope**: ~77 pages across 14 navigation sections. 11+ validated `.ias` example files. 7 agentic architecture use cases.

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| # | Principle | Status | Notes |
|---|-----------|--------|-------|
| I | Determinism | PASS | Documentation builds are deterministic — same Markdown input produces same HTML output. Example validation uses the deterministic parser. |
| II | Idempotency | PASS | Running `mkdocs build` twice produces identical output. Deploying unchanged content to GitHub Pages is a no-op. |
| III | Portability | N/A | Documentation is a static site. No platform-specific behavior. |
| IV | Separation of Concerns | PASS | Content (Markdown) is separated from presentation (MkDocs theme). Code examples are validated independently of site rendering. |
| V | Reproducibility | PASS | MkDocs and Pygments versions pinned in `requirements.txt`. Go dependencies pinned in `go.mod`. |
| VI | Safe Defaults | PASS | No secrets in documentation. Example code uses placeholder values with comments. |
| VII | Minimal Surface Area | PASS | Each documented construct has a concrete use case with example. No speculative documentation. |
| VIII | English-Friendly Syntax | PASS | Documentation is written in plain English. Code examples demonstrate the English-friendly IntentLang syntax. |
| IX | Canonical Formatting | PASS | All `.ias` examples pass `agentspec fmt` — canonical formatting is demonstrated throughout. |
| X | Strict Validation | PASS | Every `.ias` code block is validated during build (FR-015) via Go integration test. `--strict` omitted from `mkdocs build` due to upstream mkdocs-material MkDocs 2.0 warning. |
| XI | Explicit References | PASS | Documentation references specific versions. No floating dependency links. |
| XII | No Hidden Behavior | PASS | CI pipeline is fully declared. No undocumented transforms. |

**Contracts**:

| Contract | Status | Notes |
|----------|--------|-------|
| Desired-State Engine | N/A | This feature is documentation, not engine changes. |
| Adapter Contract | N/A | No new adapters. Documentation covers existing adapters. |
| Plugin Contract | N/A | No new plugins. Documentation covers existing plugin system. |
| SDK Contract | N/A | No new SDK code. Documentation covers existing SDKs. |

**Post-Design Re-Check**: All gates pass. No constitution violations.

## Project Structure

### Documentation (this feature)

```text
specs/005-docs-site/
├── plan.md              # This file
├── spec.md              # Feature specification
├── research.md          # Phase 0 research findings
├── data-model.md        # Entity definitions and site navigation model
├── quickstart.md        # Local development setup guide
├── contracts/
│   └── site-structure.md # Site directory layout and configuration contract
└── tasks.md             # Task breakdown (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
docs/                               # Documentation source root (NEW)
├── index.md                        # Site homepage
├── user-guide/                     # User Guide tab
│   ├── getting-started/
│   │   ├── index.md                # Installation & overview
│   │   ├── quickstart.md           # Quick start tutorial
│   │   └── concepts.md             # Core concepts
│   ├── language/
│   │   ├── index.md                # Language overview
│   │   ├── agent.md                # agent block reference
│   │   ├── prompt.md               # prompt block reference
│   │   ├── skill.md                # skill block reference
│   │   ├── tool.md                 # tool variants reference
│   │   ├── deploy.md               # deploy block reference
│   │   ├── pipeline.md             # pipeline block reference
│   │   ├── type.md                 # type definition reference
│   │   ├── server.md               # server block reference
│   │   ├── client.md               # client block reference
│   │   ├── secret.md               # secret block reference
│   │   ├── environment.md          # environment block reference
│   │   ├── policy.md               # policy block reference
│   │   └── plugin.md               # plugin block reference
│   ├── configuration/
│   │   ├── runtime.md              # Agent runtime attributes
│   │   ├── prompt-variables.md     # Template variables
│   │   ├── error-handling.md       # Error strategies
│   │   └── delegation.md           # Agent delegation
│   ├── use-cases/
│   │   ├── index.md                # Architecture overview & comparison
│   │   ├── react.md                # ReAct agent
│   │   ├── plan-execute.md         # Plan-and-Execute
│   │   ├── reflexion.md            # Reflexion
│   │   ├── router.md               # Router / Triage
│   │   ├── map-reduce.md           # Map-Reduce
│   │   ├── pipeline.md             # Multi-Agent Pipeline
│   │   └── delegation.md           # Agent Delegation
│   ├── deployment/
│   │   ├── index.md                # Deployment overview
│   │   ├── process.md              # Local process
│   │   ├── docker.md               # Docker
│   │   ├── compose.md              # Docker Compose
│   │   ├── kubernetes.md           # Kubernetes
│   │   └── best-practices.md       # Production best practices
│   ├── cli/
│   │   ├── index.md                # CLI overview
│   │   ├── validate.md
│   │   ├── fmt.md
│   │   ├── plan.md
│   │   ├── apply.md
│   │   ├── run.md
│   │   ├── dev.md
│   │   ├── status.md
│   │   ├── logs.md
│   │   ├── destroy.md
│   │   ├── init.md
│   │   ├── migrate.md
│   │   ├── export.md
│   │   ├── diff.md
│   │   ├── sdk.md
│   │   └── version.md
│   ├── api/
│   │   ├── index.md                # API overview & auth
│   │   ├── agents.md               # Agent endpoints
│   │   ├── sessions.md             # Session endpoints
│   │   ├── pipelines.md            # Pipeline endpoints
│   │   └── health-metrics.md       # Health & metrics
│   ├── sdks/
│   │   ├── python.md
│   │   ├── typescript.md
│   │   └── go.md
│   ├── migration.md                # IntentLang 1.0 → 2.0
│   └── changelog.md
│
├── developer-guide/                # Developer Guide tab
│   ├── architecture/
│   │   ├── index.md                # Architecture overview
│   │   ├── parser.md               # Parser pipeline
│   │   ├── ir.md                   # IR and plan engine
│   │   ├── runtime.md              # Runtime and agentic loop
│   │   ├── adapters.md             # Adapter system
│   │   └── plugins.md              # Plugin host
│   ├── contributing/
│   │   ├── index.md                # Build from source
│   │   ├── testing.md              # Running tests
│   │   ├── code-style.md           # Code conventions
│   │   └── pull-requests.md        # PR guidelines
│   ├── extending/
│   │   ├── adapters.md             # Writing custom adapters
│   │   └── plugins.md              # Writing WASM plugins
│   └── internals/
│       ├── state.md                # State management
│       ├── secrets.md              # Secret resolution
│       ├── telemetry.md            # Observability
│       └── sdk-generation.md       # SDK code generation
│
├── examples/                       # Validated .ias example files
│   ├── basic-agent.ias
│   ├── customer-support.ias
│   ├── code-review-pipeline.ias
│   ├── rag-chatbot.ias
│   ├── data-pipeline.ias
│   ├── react-agent.ias
│   ├── plan-execute-agent.ias
│   ├── reflexion-agent.ias
│   ├── router-agent.ias
│   ├── map-reduce-agent.ias
│   └── delegation-agent.ias
│
└── stylesheets/
    └── extra.css                   # Custom CSS

docs-tools/                         # Documentation tooling (NOT published)
├── pygments_intentlang/            # Custom Pygments lexer
│   ├── __init__.py
│   ├── lexer.py                    # IntentLang token definitions
│   └── setup.py                    # Entry point registration
└── requirements.txt                # Python dependencies (pinned)

mkdocs.yml                          # MkDocs configuration

.github/workflows/
└── docs.yml                        # MODIFY — add docs build+deploy workflow

integration_tests/
└── docexample_test.go              # NEW — .ias code block validation test
```

**Structure Decision**: Documentation source lives in `docs/` at the repository root, following MkDocs conventions. Documentation tooling (Pygments lexer) lives in `docs-tools/` and is not published as part of the site. The `mkdocs.yml` configuration sits at the repository root. A new Go integration test validates all `.ias` code blocks embedded in documentation Markdown files.

## Implementation Phases

### Phase 1: Site Foundation

**Goal**: MkDocs project initialized, custom IntentLang syntax highlighting working, site builds and serves locally. GitHub Actions workflow deploys to GitHub Pages.

**Scope**:
- Create `mkdocs.yml` with Material for MkDocs configuration, navigation tabs, search, Mermaid support
- Create `docs/index.md` homepage
- Create `docs-tools/pygments_intentlang/` custom Pygments lexer for IntentLang syntax highlighting
- Create `docs-tools/requirements.txt` with pinned dependencies
- Create `.github/workflows/docs.yml` CI workflow (build Go binary, validate examples, build site, deploy)
- Create `docs/stylesheets/extra.css` for minor theme customizations
- Verify the site builds locally with `mkdocs serve`

**Dependencies**: None

**Constitution gates**: V (reproducibility — pinned dependencies), IX (canonical formatting — examples formatted)

### Phase 2: Language Reference & Getting Started

**Goal**: Complete IntentLang 2.0 language reference with all resource types documented. Getting started guide walks new users from installation to running their first agent.

**Scope**:
- Create `docs/user-guide/getting-started/` (3 pages: index, quickstart, concepts)
- Create `docs/user-guide/language/` (14 pages: overview + 13 resource types)
  - Each page: syntax definition, attribute table, valid values, annotated examples
  - Source content from `spec/spec.md`, existing `examples/`, and `README.md`
- Create `docs/user-guide/configuration/` (4 pages: runtime, prompt variables, error handling, delegation)
- Create validated `.ias` example files in `docs/examples/` (copy/adapt from `examples/`)
- Create `integration_tests/docexample_test.go` — Go test that extracts and validates `.ias` code blocks

**Dependencies**: Phase 1 (site must build)

**Constitution gates**: VII (each keyword documented with example), X (all examples validated)

### Phase 3: Use Cases & Deployment

**Goal**: Use-case catalog with 7+ agentic architectures and Mermaid diagrams. Deployment guides for all 4 targets with production best practices.

**Scope**:
- Create `docs/user-guide/use-cases/` (8 pages: overview + 7 architecture patterns)
  - Each page: problem statement, Mermaid architecture diagram, complete `.ias` example, when to use, trade-offs
  - Architecture comparison table on overview page
  - Create new validated `.ias` examples for each pattern (react, plan-execute, reflexion, router, map-reduce, pipeline, delegation)
- Create `docs/user-guide/deployment/` (6 pages: overview + 4 targets + best practices)
  - Each target: prerequisites, `deploy` block reference, step-by-step, health check, verification
  - Best practices: secret management, monitoring, scaling, CI/CD integration

**Dependencies**: Phase 2 (language reference needed for cross-linking)

**Constitution gates**: III (portability — documented across 4 targets), VI (safe defaults — secret best practices)

### Phase 4: CLI, API, & SDK Reference

**Goal**: Complete CLI command reference, HTTP API reference with curl examples, and SDK documentation for all 3 languages.

**Scope**:
- Create `docs/user-guide/cli/` (16 pages: overview + 15 commands)
  - Extract flag/usage information from `cmd/agentspec/*.go` source files
  - Each page: usage syntax, flags table, examples, success/error output
- Create `docs/user-guide/api/` (5 pages: overview/auth, agents, sessions, pipelines, health/metrics)
  - Request/response schemas, authentication (X-API-Key, Bearer), curl examples
  - Source from runtime API contract and `internal/runtime/server.go`
- Create `docs/user-guide/sdks/` (3 pages: Python, TypeScript, Go)
  - Installation, client initialization, invocation, streaming, sessions, error handling
  - Source from `sdk/` directory and generated SDK code
- Create `docs/user-guide/migration.md` (IntentLang 1.0 → 2.0 migration guide)
- Create `docs/user-guide/changelog.md` (from existing `CHANGELOG.md`)

**Dependencies**: Phase 2 (language reference for cross-linking)

**Constitution gates**: N/A (documentation only)

### Phase 5: Developer Guide

**Goal**: Complete developer/contributor documentation with architecture docs, build guide, and extensibility guides.

**Scope**:
- Create `docs/developer-guide/architecture/` (6 pages)
  - Source from `ARCHITECTURE.md` and internal package documentation
  - Parser pipeline, IR, runtime, adapters, plugins
- Create `docs/developer-guide/contributing/` (4 pages)
  - Build from source, test guide, code style, PR guidelines
- Create `docs/developer-guide/extending/` (2 pages)
  - Custom adapter guide with interface definition and example
  - WASM plugin guide with contract and example
- Create `docs/developer-guide/internals/` (4 pages)
  - State management, secret resolution, telemetry, SDK generation

**Dependencies**: Phase 1 (site must build)

**Constitution gates**: N/A (documentation only)

### Phase 6: Polish & Validation

**Goal**: Full validation pass. All examples validated, all links verified, search working, CI deploying.

**Scope**:
- Run `mkdocs build` and fix all warnings (broken links, missing pages)
- Run `go test ./integration_tests/ -run TestDocExamples -v` and fix all validation failures
- Verify search returns relevant results for all IntentLang keywords
- Verify navigation structure (max 3 clicks to any page)
- Verify GitHub Pages deployment works end-to-end
- Add sitemap configuration and SEO metadata
- Cross-link between related pages (language reference ↔ use cases, CLI ↔ API, etc.)
- Review all pages for consistency in tone, formatting, and depth

**Dependencies**: Phases 2-5 (all content must be written)

**Constitution gates**: X (strict validation — all examples valid, all links working)

## Complexity Tracking

No constitution violations requiring justification. All gates pass.
