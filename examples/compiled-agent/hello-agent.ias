package "hello-agent" version "1.0.0" lang "3.0"

prompt "greeting" {
  content "You are a friendly greeting assistant. When someone says hello, respond warmly with their name if provided. Always be positive and helpful."
}

skill "get_time" {
  description "Returns the current time"
  input {
    timezone string
  }
  output {
    time string
  }
  tool inline {
    language "bash"
    code "date +%H:%M:%S"
  }
}

agent "hello" {
  model "claude-sonnet-4-20250514"
  prompt "greeting"
  uses skill "get_time"
  strategy "react"
  max_turns 5
  timeout "30s"
  token_budget 50000
  stream true
  on_error "retry"
  max_retries 2

  config {
    greeting_style string default "friendly" "Style of greeting: friendly, formal, casual"
    max_name_length int default "50" "Maximum length for user names"
    api_key string required secret "API key for the LLM provider"
  }

  validate {
    rule output_not_empty error "Response must not be empty" when output != ""
    rule no_profanity warning "Response should not contain inappropriate language" when output != ""
  }

  eval {
    case greeting_test input "Hello, my name is Alice" expect "Hello Alice" scoring contains threshold 0.7 tags ["greeting" "basic"]
    case empty_input input "hi" expect "Hello! How can I help you today?" scoring semantic threshold 0.6 tags ["edge-case"]
  }
}

deploy "local" target "process" {
  port 8080
  health {
    path "/healthz"
  }
}
